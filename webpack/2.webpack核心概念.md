

### ä¸€. loaderæ˜¯ä»€ä¹ˆï¼Ÿ

ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„æ‰“åŒ…æ˜¯æ­£å¸¸çš„ï¼Œç°åœ¨æˆ‘ä»¬åŠ ä¸Šä¸€å¼ å›¾ç‰‡è¯•è¯•ã€‚

srcä¸‹æ–°å»ºdoge.js

```js
import dogeIcon from './img/doge.jpg'

export default function Header () {
  var dom = document.getElementById('root')
  const doge = new Image()
  doge.src = dogeIcon
  dom.append(doge)
}
```

index.js

```js
import doge from './doge.js'
import Header from './header.js'
new Header()
new doge()
```



æ‰“åŒ…ï¼Œnpm run bundle

æŠ¥é”™äº†ã€‚ã€‚ã€‚

åŸå› ï¼šjpgæ ¼å¼æ–‡ä»¶æ‰“åŒ…å‡ºäº†é—®é¢˜ã€‚webpackåªçŸ¥é“æ€ä¹ˆæ‰“åŒ…jsæ–‡ä»¶ï¼Œå…¶ä»–æ–‡ä»¶ä»–ä¸ä¼šå•Šå•Šå•Šå•Šå•Š~~æˆ‘ä»¬éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å‘Šè¯‰ä»–æ€ä¹ˆåšã€‚

```js
module: {
    rules: [{
        test: /\.jpg$/,
        use: {
            loader: 'file-loader'
        }
    }]
}
```

æ„æ€æ˜¯ï¼Œwebpackä½ é‡åˆ°ä¸çŸ¥é“æ€ä¹ˆæ‰“åŒ…æ—¶ï¼Œæ¥é…ç½®å±æ€§moduleè¿™æ¥æ‰¾æˆ‘ï¼Œæˆ‘æ•™ä½ ã€‚

å½“é‡åˆ°ä»¥jpgæ ¼å¼ç»“å°¾çš„æ–‡ä»¶æ—¶ï¼Œç”¨file-loaderè¿™ä¸ªloaderæ¥æ‰“åŒ…ã€‚



å½“ç„¶è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å®‰è£…è¯¥loader

`npm i -d file-loader`



æ‰“åŒ…åï¼Œå›¾ç‰‡å¹¶æœªæ­£å¸¸æ˜¾ç¤ºã€‚

æˆ‘ä»¬æ‰¾ä¸‹åŸå› ï¼š

æ³¨æ„ï¼Œæ­¤æ—¶bundleæ–‡ä»¶å¤¹é‡Œé™¤äº†ä¹‹å‰çš„jsæ–‡ä»¶ï¼Œè¿˜å¤šäº†ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ã€‚

æ‰“å°ä¸€ä¸‹importçš„å›¾ç‰‡ï¼Œä»–çš„åå­—å’Œbundleä¸‹çš„å›¾ç‰‡åå­—ä¸€æ ·ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬æ¨æµ‹ï¼š

file-loaderå½“å‘ç°é¡¹ç›®ä¸­æœ‰å¼•å…¥å›¾ç‰‡æ–‡ä»¶æ—¶ï¼Œä»–ä¼šæŠŠå›¾ç‰‡å¤åˆ¶åˆ°æ‰“åŒ…è¾“å‡ºæ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”å–ä¸€ä¸ªåå­—ï¼Œ å¹¶å°†è¯¥åå­—è¿”ç»™å¼•å…¥å›¾ç‰‡æ—¶çš„å˜é‡ä¸­ã€‚ ç†è®ºä¸Šï¼Œé™¤äº†å›¾ç‰‡ï¼Œä»»ä½•é™æ€æ–‡ä»¶éƒ½æ˜¯åŒç†ã€‚

äº‹å®ä¸Šï¼Œä¹Ÿç¡®å®æ˜¯è¿™æ ·çš„ã€‚



å¦å¤–ï¼Œçœ‹ä¸‹æˆ‘ä»¬çš„å·¥ç¨‹ç›®å½•

![3](https://tva3.sinaimg.cn/mw690/006lIpJvly1gija70wengj30an0cnjri.jpg)

æˆ‘ä»¬æ‰‹åŠ¨å°†index.htmlç§»åˆ°äº†bundleæ–‡ä»¶å¤¹ä¸‹ã€‚ä¹‹åä¼šæœ‰ç›¸å…³è‡ªåŠ¨åŒ–å·¥å…·ä»‹ç»ã€‚



æ‰€ä»¥ï¼Œloaderæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

webpackä¸èƒ½è¯†åˆ«éjsæ ¼å¼çš„æ–‡ä»¶ï¼Œæ­¤æ—¶å°±éœ€è¦loaderæ¥å¸®åŠ©æ‰“åŒ…ã€‚æœ‰åƒåƒä¸‡ä¸‡ä¸ªloaderï¼Œå¯¹åº”ä¸åŒçš„åŠŸèƒ½ã€‚



### äºŒ. ä½¿ç”¨loaderæ‰“åŒ…é™æ€èµ„æºï¼ˆå›¾ç‰‡ï¼‰

#### 1. å›¾ç‰‡æ‰“åŒ…ååå­—ä¸å˜

åœ¨loaderä¸­é…ç½®

```js
module: {
    rules: [{
      test: /\.(jpg|png|gif)$/, //æ‰€æœ‰å›¾ç‰‡
      use: {
        loader: 'file-loader',
        options: {
          name: '[name]_[hash].[ext]', //å ä½ç¬¦
          outputPath: 'images/' //è¯¥loaderè¾“å‡ºè·¯å¾„
        }
      }
    }]
  },
```



#### 2. url-loader

url-loaderèƒ½å¤Ÿå®Œå…¨æ›¿ä»£file-loader

`npm i -d url-loader`

å°†file-loaderæ›¿æ¢æˆurl-loaderï¼Œå…¶ä½™ä¸å˜

```js
module: {
    rules: [{
      test: /\.(jpg|png|gif)$/, //æ‰€æœ‰å›¾ç‰‡
      use: {
        loader: 'url-loader',
        options: {
          name: '[name]_[hash].[ext]', //å ä½ç¬¦
          outputPath: 'images/' //è¯¥loaderè¾“å‡ºè·¯å¾„
        }
      }
    }]
  },
```

æ‰“åŒ…ï¼Œ æˆ‘ä»¬å‘ç°bundleç›®å½•ä¸‹æ²¡æœ‰å›¾ç‰‡æ–‡ä»¶ï¼Œ

è¿™å°±æ˜¯url-loaderä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œä»–é»˜è®¤ä¼šå°†å›¾ç‰‡è½¬æ¢æˆbase64ç›´æ¥å†™å…¥bundle.jsä¸­ã€‚

- ä¼˜ç‚¹ï¼šä¸ç”¨å¼•å…¥å›¾ç‰‡ã€‚
- ç¼ºç‚¹ï¼šå½“å›¾ç‰‡éå¸¸å¤§æ—¶ï¼Œjsä¼šå˜å¾—éå¸¸å¤§ã€‚

- æœ€ä½³å®è·µï¼šå½“å›¾ç‰‡æ¯”è¾ƒå°æ—¶ï¼Œç”¨base64ï¼›åä¹‹å¼•å…¥å›¾ç‰‡ã€‚æ°å¥½url-loaderæä¾›äº†è¯¥åŠŸèƒ½â†“

  ```js
  module: {
      rules: [{
        test: /\.(jpg|png|gif)$/, //æ‰€æœ‰å›¾ç‰‡
        use: {
          loader: 'url-loader',
          options: {
            name: '[name]_[hash].[ext]', //å ä½ç¬¦
            outputPath: 'images/', //è¯¥loaderè¾“å‡ºè·¯å¾„
            limit: 20480 // 20kbä¸ºç•Œ
          }
        }
      }]
    },
  ```

å†æ¬¡æ‰“åŒ…ï¼Œokkï¼

### ä¸‰. ä½¿ç”¨loaderæ‰“åŒ…é™æ€æ–‡ä»¶ï¼ˆæ ·å¼ï¼‰

#### 1. ä¸€èˆ¬æ ·å¼æ–‡ä»¶

æˆ‘ä»¬çš„å›¾ç‰‡çœ‹èµ·æ¥å¥½å¤§ï¼Œå¾—åŠ ä¸ªé«˜å®½æ ·å¼ã€‚

 ```js
// doge.js
import dogeIcon from './img/doge.jpg'
import './doge.css'

export default function Header () {
  var dom = document.getElementById('root')
  const doge = new Image()
  doge.classList.add('img')
  doge.src = dogeIcon
  dom.append(doge)
}
 ```

æ‰“åŒ…ï¼ŒæŠ¥é”™ã€‚



æ²¡é”™ï¼Œwebpackä¸è®¤è¯†cssã€‚æ‰€ä»¥è¦é…ç½®loader

```js
npm i -d style-loader css-loader
```

```js
{
    test: /\.css$/,
    use: ['style-loader', 'css-loader']
  }
```

å†æ‰“åŒ…ï¼ŒohyeahæˆåŠŸï¼Œå›¾ç‰‡ä¹Ÿç¡®å®å˜å°äº†ã€‚

åˆ†æä¸€ä¸‹

css-loaderï¼šå¸®åŠ©æˆ‘ä»¬åˆ†æå¤šä¸ªcssæ–‡ä»¶çš„å…³ç³»ï¼Œå¹¶å°†å…¶åˆå¹¶æˆä¸€ä¸ªcssæ–‡ä»¶ã€‚

style-loaderï¼šå°†css-loaderç”Ÿæˆçš„cssæ–‡ä»¶æŒ‚è½½åˆ°é¡µé¢çš„headé‡Œé¢ã€‚



#### 2. é¢„ç¼–è¯‘æ ·å¼æ–‡ä»¶

æˆ‘ä»¬æ–°å»ºdoge.lesså¹¶åœ¨doge.jsä¸­å¼•å…¥ã€‚

```less
.img {
  border-radius: 50%;
}
```



å†æ‰“åŒ…ï¼Œå“¦è±ï¼Œåˆå¤±è´¥äº†ã€‚

é…ç½®ï¼Œ

```js
npm i -d less-loader less
```

```js
{
    test: /\.less$/,
    use: ['style-loader', 'css-loader', 'less-loader']
  }
```



æ‰“åŒ…ï¼ŒæˆåŠŸã€‚

less-loaderï¼šå°†lessç¼–è¯‘æˆcssã€‚



#### 3. loaderçš„é¡ºåº

loaderçš„ä½¿ç”¨æ˜¯ä»å³å‘å·¦çš„ã€‚å¾ˆé‡è¦ã€‚



#### 4. å‚å•†å‰ç¼€

emmmï¼Œåæ­£æ˜¯ä¸ºäº†å…¼å®¹ã€‚

```js
npm i -d postcss-loader autoprefixer
```

æ ¹ç›®å½•ä¸‹æ–°å»º `postcss.config.js` æ–‡ä»¶

```js
module.exports = {
  plugins: [
    require('autoprefixer')// å‚å•†å‰ç¼€
  ]
}
```

ä¿®æ”¹lessçš„loaderé…ç½®

```js
{
    test: /\.less$/,
    use: ['style-loader', 'css-loader', 'less-loader', 'postcss-loader']
}
```

æ‰“åŒ…ï¼Œæ²¡æœ‰ç”Ÿæˆå‰ç¼€ã€‚ä»€ä¹ˆé¬¼ï¼Ÿ

ä¹‹æ‰€ä»¥æ²¡æœ‰å‰ç¼€æ˜¯å› ä¸ºï¼Œwebpackè®¤ä¸ºä½ åœ¨é«˜çº§æµè§ˆå™¨ä¸­ä½¿ç”¨è¿™äº›ç‰¹æ€§ï¼Œé«˜çº§æµè§ˆå™¨å·²ç»æ²¡å¿…è¦åŠ è¿™äº›å‰ç¼€äº†ã€‚æ‰€ä»¥å¦‚æœè¦åŠ ï¼Œæˆ‘ä»¬åœ¨browserListé…ç½®é‡Œé¢åŠ ä¸Šè€ç‰ˆæœ¬æµè§ˆå™¨çš„å…¼å®¹ï¼Œé‚£ä¹ˆæ‰“åŒ…å°±ä¼šç»™ä½ åŠ å‰ç¼€çš„

å¦‚

```js
//package.json
"browserslist": [
    "> 1%",
    "last 2 versions",
    "not ie <= 8"
  ]
```

é‡æ–°æ‰“åŒ…ï¼Œokkï¼

#### 5. css-loaderé…ç½®é¡¹

```js
//...
{
    loader: 'css-loader',
    options: {
        importLoaders: 2
    }
}
//...
```

why: å½“åœ¨ä¸€ä¸ªæ ·å¼æ–‡ä»¶ä¸­å¼•å…¥å¦ä¸€ä¸ªæ ·å¼æ–‡ä»¶æ—¶ï¼Œè¢«å¼•å…¥çš„æ ·å¼æ–‡ä»¶å¯èƒ½ä¸ä¼šèµ°css-loaderåé¢çš„less-loaderå’Œpostcss-loaderã€‚åŠ ä¸Š`importLoaders: 2`åå°±æ˜¯åœ¨é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼ˆä»jsæ–‡ä»¶æˆ–cssæ–‡ä»¶ä¸­å¼•å…¥ï¼‰å‘Šè¯‰webpackåé¢è¿˜æœ‰ä¸¤ä¸ªæµç¨‹æ²¡èµ°å‘ã€‚:dog2:

#### 6. css-module

æˆ‘ä»¬åœ¨srcä¸­æ–°å»ºcreateDoge.js

```js
import dogeIcon from './img/doge.jpg'

export default function createDoge() {
  var dom = document.getElementById('root')
  const doge = new Image()
  doge.classList.add('img')
  doge.src = dogeIcon
  dom.append(doge)
}
```

indes.jsä¹Ÿæ”¹ä¸€ä¸‹

```js
import doge from './doge.js'
import Header from './header.js'
import createDoge from './createDoge.js'
new Header()
new doge()
createDoge()
```

æ‰“åŒ…ï¼Œè¿è¡Œã€‚æ²¡æ¯›ç—…ã€‚

ä½†æ˜¯ï¼Œä¸¤åªdogeæ ·å¼æ˜¯ä¸€æ ·çš„ã€‚createDoge.jsåˆ›å»ºçš„dogeæˆ‘æ˜æ˜æ²¡å¼•å…¥æ ·å¼å•Šã€‚å…¶å®æ˜¯å› ä¸ºcssé»˜è®¤æ˜¯å…¨å±€ç”Ÿæ•ˆçš„ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ªdogeçš„æ ·å¼å½±å“åˆ°äº†ç¬¬äºŒä¸ªdogeã€‚è¿™æ˜¾ç„¶å’Œæ­£å¸¸çš„éœ€æ±‚ä¸ç¬¦ã€‚

æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨åˆ°css modules

é…ç½®æ–‡ä»¶å¼€å¯css modulesâ†“

```js
 {
        test: /\.css$/,
        use: [
          'style-loader',
          {
            loader: 'css-loader',
            options: {
              modules: true
            }
          },
        ]
      },
      {
        test: /\.less$/,
        use: [
          'style-loader',
          {
            loader: 'css-loader',
            options: {
              importLoaders: 2,
              modules: true
            }
          },
          'less-loader',
          'postcss-loader'
        ]
      }
```

doge.js

```js
import dogeIcon from './img/doge.jpg'
// é…ç½®äº†å¹¶ä¸”è¿™æ ·å†™æ‰æ˜¯css modulesï¼Œç¼ºä¸€ä¸å¯
import style1 from './doge.css'
import style2 from './doge.less'

export default function Header () {
  var dom = document.getElementById('root')
  const doge = new Image()
  doge.classList.add(style1.img, style2.img)
  doge.src = dogeIcon
  dom.append(doge)
}
```

æ‰“åŒ…ï¼Œ è¿è¡Œã€‚okï¼Œä¸¤åªdogeçš„æ ·å¼äº’ä¸å½±å“äº†ã€‚

#### 7. å­—ä½“æ–‡ä»¶

- åœ¨iconfontä¸Šä¸‹è½½é˜¿é‡Œå·´å·´æ™®æƒ ä½“ã€‚
- è§£å‹åå°†å­—ä½“æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰æ‹·è´è‡³src/fontæ–‡ä»¶å¤¹ä¸‹ã€‚

- srcä¸‹æ–°å»ºfont.css

  ```css
  @font-face {
    font-family: "webfont";
    font-display: swap;
    src: url('./font/webfont.eot'); /* IE9 */
    src: url('./font/webfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
    url('./font/webfont.woff2') format('woff2'),
    url('./font/webfont.woff') format('woff'), /* chromeã€firefox */
    url('./font/webfont.ttf') format('truetype'), /* chromeã€firefoxã€operaã€Safari, Android, iOS 4.2+*/
    url('./font/webfont.svg#webfont') format('svg'); /* iOS 4.1- */
  }
  
  .webFont {
    font-family: "webfont" !important;
    font-size: 16px;
    font-style: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  ```

  

- header.jså¼•å…¥å¹¶ä½¿ç”¨

  ```js
  import style from './font.css'
  
  export default function Header () {
    var dom = document.getElementById('root')
    const header = document.createElement('div')
    header.classList.add(style.webFont)
    header.innerHTML = 'å¿ƒä¹‹æ‰€å‘ï¼Œç´ å±¥ä»¥å¾€ï¼Œç”Ÿå¦‚é€†æ—…ã€‚'
    dom.append(header)
  }
  ```



æ‰“åŒ…ï¼ŒæŠ¥é”™ã€‚555~

é…ç½®

```js
{
    test: /\.(eot|ttf|svg|woff|woff2)$/,
    use: {
      loader: 'file-loader',
      options: {
        outputPath: 'font/', //è¯¥loaderè¾“å‡ºè·¯å¾„
        name: '[name].[ext]' //å ä½ç¬¦
      }
    }
},
```

æ‰“åŒ…ï¼Œè¿è¡Œã€‚æˆåŠŸã€‚



### å››. pluginsæ˜¯ä»€ä¹ˆ

webpackçš„æ’ä»¶ï¼ˆåœ¨webpackçš„æŸä¸ªç”Ÿå‘½å‘¨æœŸåšæŸä»¶äº‹ï¼‰



#### 1. è®©æ‰“åŒ…æ›´ä¾¿æ·

å…¶å®ä¹‹å‰æ‰“åŒ…ä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼Œbundleæ–‡ä»¶å¤¹é‡Œçš„htmlæ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ‹·è´è¿›å»çš„ã€‚ä¸€ç‚¹éƒ½ä¸æ™ºèƒ½ã€‚

`npm i -D html-webpack-plugin`

é…ç½®æ–‡ä»¶ä¸­å¼•å…¥

```js
const htmlWebpakPlugin = require('html-webpack-plugin')
//...
    //pluginsé…ç½®
    plugins: [
      new htmlWebpakPlugin()
    ],
```

html-webpack-pluginï¼šä¼šåœ¨æ‰“åŒ…ç»“æŸæ—¶åœ¨outputè·¯å¾„è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œå¹¶å°†æ‰“åŒ…çš„jsæ–‡ä»¶è‡ªåŠ¨å¼•è¿›å»ã€‚

ä½†æ˜¯ï¼Œè¿™ä¸ªhtmlæ²¡æœ‰idä¸ºrootçš„divã€‚

å’‹åŠå˜~

ç»§ç»­é…ç½®

```js
//pluginsé…ç½®
plugins: [
  new htmlWebpakPlugin({
      template: 'src/index.html' //é…ç½®æ¨¡æ¿
    })
],
```

srcä¸‹æ–°å»ºindex.html

```html
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>webpack demo 2</title>
</head>
<body>
  <div id="root"></div>
</body>
</html>
```

åˆ é™¤bundleï¼Œæ‰“åŒ…ï¼Œè¿è¡Œï¼Œä¸€æ°”å‘µæˆğŸ‘¨



è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚

ç¬¬ä¸€æ¬¡æˆ‘æ‰“åŒ…ç”Ÿæˆäº†ä¸€ä¸ªjsæ–‡ä»¶å’Œå…¶ä»–é™æ€æ–‡ä»¶ï¼Œ

ç„¶åæˆ‘ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ï¼Œä½¿æ‰“åŒ…æ–‡ä»¶çš„åå­—å˜äº†ã€‚

ç¬¬äºŒæ¬¡åˆæ‰“åŒ…ï¼Œemmï¼Œæ–°çš„æ—§çš„æ–‡ä»¶éƒ½æœ‰ï¼Œå†—ä½™äº†ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰“åŒ…æ—¶å…ˆåˆ é™¤æ—§æ–‡ä»¶ï¼Œå†ç”Ÿæˆæ–°æ–‡ä»¶ã€‚

`npm i -D clean-webpack-plugin`

```js
const {CleanWebpackPlugin} = require('clean-webpack-plugin')
//...
//pluginsé…ç½®
  plugins: [
    //...
    new CleanWebpackPlugin() //åœ¨æ‰“åŒ…ä¹‹å‰åˆ é™¤outputå®šä¹‰çš„è·¯å¾„æ–‡ä»¶å¤¹(bundleæ–‡ä»¶å¤¹)
  ],
```

æ‰“åŒ…è¿è¡Œï¼Œok

### äº”. entryä¸outputçš„åŸºæœ¬é…ç½®

#### 1. é»˜è®¤é…ç½®

```js
entry: './src/index.js'

// ç­‰ä»·äº

entry: {
    main: './src/index.js'
}
```

â€‹	main.jsæ˜¯é»˜è®¤åå­—ã€‚å¦‚outputä¸­ä¸æŒ‡å®šç”Ÿæˆæ–‡ä»¶åï¼Œåˆ™bundleæ–‡ä»¶å¤¹ç”Ÿæˆçš„jsæ–‡ä»¶å«main.js.

#### 2. æ‰“åŒ…å¤šä¸ªjsæ–‡ä»¶çš„éœ€æ±‚

```js

entry: {
    main: './src/index.js',
    sub: './src/sub.js'
}
//...
output: {
    fileName: '[name].js' //ç”Ÿæˆmain.jså’Œsub.js
}
```

#### 3. æ‰“åŒ…åçš„htmlå¼•å…¥jsæ–‡ä»¶åŠ å‰ç¼€

```js
//...
output: {
    publicPath: 'https://cdn.com.cn'
}
```

åœºæ™¯ï¼šjsæŒ‚åœ¨cdnä¸Šã€‚



### å…­. sourceMapçš„é…ç½®

#### 1. sourceMapæ˜¯ä»€ä¹ˆ

ä¸€ä¸ªæ˜ å°„å…³ç³»ã€‚é€šè¿‡å®ƒå¯ä»¥çŸ¥é“æ‰“åŒ…åçš„æ–‡ä»¶çš„æŸä¸ªä½ç½®å¯¹åº”æºä»£ç çš„æŸä¸ªä½ç½®ã€‚

åœºæ™¯ï¼šæŠ¥é”™ä¿¡æ¯æç¤ºå…·ä½“æºä»£ç ä½ç½®ã€‚

æ —å­â†“

```js
// index.js
//...
consele.log('err')
```

æ‰“åŒ…æˆåŠŸï¼Œè¿è¡ŒæŠ¥é”™ï¼Œé”™è¯¯æŒ‡å‘bundle.jsã€‚æˆ‘å’‹æ”¹ï¼Ÿè„‘å£³ç–¼~



ä¿®æ”¹é…ç½®æ–‡ä»¶

```js
//...
devtool: 'source-map'
```

æ‰“åŒ…è¿è¡Œï¼ŒæŠ¥é”™ä½ç½®æŒ‡å‘æºä»£ç äº†ã€‚å˜¿å˜¿



#### 2. devtoolçš„å¸¸ç”¨å€¼

![5](https://tvax3.sinaimg.cn/mw690/006lIpJvgy1gimp7nlivcj30jh0jd412.jpg)

- inline

  ä¸ä¼šåœ¨bundleæ–‡ä»¶å¤¹ä¸‹ç”ŸæˆsourceMapæ–‡ä»¶ï¼Œè€Œæ˜¯ä»¥base64çš„å½¢å¼å°†å…¶æ”¾åˆ°jsæ–‡ä»¶ä¸­å»ã€‚

- cheap

  æ²¡æœ‰cheapï¼Œwebpackä¼šå‘Šè¯‰æˆ‘ä»¬é”™è¯¯å‡ºåœ¨ç¬¬å‡ è¡Œç¬¬å‡ åˆ—ã€‚æ²¡å¿…è¦ã€‚

  æœ‰cheapçš„è¯ï¼Œé”™è¯¯åªä¼šæŒ‡å‘ç¬¬å‡ è¡Œã€‚

- module

  é…ç½®åï¼Œwebpackä¸ä»…åªç®¡è‡ªå·±é¡¹ç›®é‡Œçš„é”™è¯¯ï¼Œè¿˜ç®¡ä¾èµ–åŒ…é‡Œçš„é”™è¯¯ã€‚

- eval

  é€Ÿåº¦æœ€å¿«ã€‚æ˜¯é€šè¿‡åœ¨jsé‡Œé¢ä½¿ç”¨evalçš„æ‰§è¡Œå½¢å¼å®ç°çš„æ˜ å°„å…³ç³»ã€‚

  ä½†å½“ä»£ç æ¯”è¾ƒå¤æ‚ï¼ŒæŠ¥é”™ä¿¡æ¯å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚

- æœ€ä½³å®è·µ

  å¼€å‘ï¼š`cheap-module-eval-source-map`

  ç”Ÿäº§ï¼š`cheap-module-source-map`



### ä¸ƒ. ä½¿ç”¨webpackDevServeræå‡å¼€å‘æ•ˆç‡

ä¹‹å‰ï¼Œæˆ‘ä»¬æ¯æ¬¡æ‰“åŒ…åï¼Œéƒ½è¦æ‰‹åŠ¨é‡æ–°æ‰“åŒ…ï¼Œæ‰‹åŠ¨æ‰“å¼€æˆ–åˆ·æ–°htmlã€‚å¤ªlowäº†ã€‚

#### 1.ç¬¬ä¸€ç§æ–¹æ³•

æ–°å¢script

```js
"watch": "webpack --watch"
```

`npm run watch`

æ”¹ä»£ç ï¼Œä¼šé‡æ–°æ‰“åŒ…ã€‚åˆ·æ–°é¡µé¢ã€‚okå˜äº†ã€‚ä¸ç”¨æ‰‹åŠ¨æ‰“åŒ…äº†ã€‚



**ç°åœ¨è¿™ç§æ–¹æ³•æœ‰ç‚¹é—®é¢˜ï¼Œå…ˆæ”¾ä¸‹ä¸ç”¨ã€‚index.htmlä¼šæ¶ˆå¤±ï¼ˆç‰ˆæœ¬é—®é¢˜ï¼‰**



#### 2. ç¬¬äºŒç§æ–¹æ³•ï¼ˆæ¨èï¼‰

`npm i -D webpack-dev-server`

é…ç½®æ–‡ä»¶

```js
devServer: { //èµ·ä¸€ä¸ªæœåŠ¡å™¨
    open: true, //è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
    contentBase: './bundle', //åœ¨å“ªèµ·æœåŠ¡å™¨
},
```

æ–°å¢script

```js
"start": "webpack-dev-server"
```

```js
npm run start
```

okï¼Œä¸ç”¨æ‰‹åŠ¨æ‰“åŒ…ä¹Ÿä¸ç”¨æ‰‹åŠ¨åˆ·æ–°äº†ã€‚



è¿˜æœ‰ä¸ªå¥½å¤„ï¼Œä»¥æ–‡ä»¶å½¢å¼æ‰“å¼€æ²¡æ³•å‘ajaxè¯·æ±‚ã€‚é€šè¿‡`webpack-dev-server`å¯ä»¥ã€‚



#### 3. ç¬¬ä¸‰ç§æ–¹æ³•

è‡ªå·±å†™ä¸€ä¸ªwebpack-dev-serverã€‚

å¤§æ¦‚å°±æ˜¯è‡ªå·±èµ·ä¸€ä¸ªnodeï¼Œç„¶ååœ¨é‡Œé¢è¿è¡Œwebpackã€‚

æ—©æœŸvueï¼Œreactè„šæ‰‹æ¶å°±æ˜¯è‡ªå·±å†™çš„ã€‚

ç®—äº†ï¼Œå…ˆä¸ç®¡è¿™å—ã€‚å¤ªéº»çƒ¦äº†ã€‚



### å…«. çƒ­æ¨¡å—æ›¿æ¢HMR

ä½¿ç”¨DevServeråï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä»£ç æ›´æ–°æ—¶ï¼Œå¹¶æ²¡æœ‰ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶ã€‚

å…¶å®DevServeræ˜¯ç”Ÿæˆäº†çš„ï¼Œåªæ˜¯ä»–å°†æ‰“åŒ…æ–‡ä»¶æ”¾åˆ°äº†ç”µè„‘å†…å­˜ä¸­ã€‚å› ä¸ºè¿™æ ·å¯ä»¥æé«˜æ‰“åŒ…é€Ÿåº¦ã€‚ğŸ˜





å½“ä»£ç æ”¹å˜æ—¶ï¼Œwebpackä¼šå¸®æˆ‘ä»¬åˆ·æ–°é¡µé¢ã€‚

ä½†æ˜¯æ¯”å¦‚æˆ‘ä»¬åªæ›´æ”¹äº†æ ·å¼æ–‡ä»¶ï¼Œå½“ç„¶æ˜¯åªå¸Œæœ›æ ·å¼æ–‡ä»¶æ›´æ–°ï¼Œè€Œä¸æ˜¯æ•´ä¸ªåˆ·æ–°å•Š~è¿™æ ·ä¼šå¯¼è‡´å·²æœ‰çš„æ“ä½œè¢«é‡ç½®ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°HMR

é…ç½®æ–‡ä»¶

```js
const webpack = require('webpack')

//...

devServer: { //èµ·ä¸€ä¸ªæœåŠ¡å™¨
    open: true, //è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
    contentBase: './bundle', //åœ¨å“ªèµ·æœåŠ¡å™¨
    hot: true, //çƒ­æ›´æ–°
    hotOnly: true //å³ä½¿hotæœªç”Ÿæ•ˆï¼Œæµè§ˆå™¨ä¹Ÿä¸è‡ªåŠ¨åˆ·æ–°
},

//...

plugins: [
    new HtmlWebpackPlugin({
      template: 'src/index.html'
    }), //åœ¨æ‰“åŒ…ä¹‹åç”Ÿæˆhtmlæ–‡ä»¶
    new CleanWebpackPlugin(), //åœ¨æ‰“åŒ…ä¹‹å‰åˆ é™¤outputå®šä¹‰çš„è·¯å¾„æ–‡ä»¶å¤¹(bundleæ–‡ä»¶å¤¹)
    new webpack.HotModuleReplacementPlugin() //å¼€å¯çƒ­æ›´æ–°
],
```





###  ä¹. babel

#### 1. ä¸šåŠ¡ä»£ç é…ç½®

å½“é¡¹ç›®ä¸­æœ‰ES6çš„è¯­æ³•æ—¶ï¼Œæœ‰äº›æµè§ˆå™¨æ˜¯ä¸è®¤è¯†çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦babelå¸®åŠ©ç¿»è¯‘æˆES5å…ˆã€‚

```js
npm i -D babel-loader @babel/core @babel/preset-env @babel/polyfill
```

é…ç½®æ–‡ä»¶

```js
rules: [
    {
        //babel
        test: /\.js$/,
        use: {
          loader: 'babel-loader',
          options: {
            presets: ['@babel/preset-env']
          }
        },
        exclude: /node_modules/
    },
    //...
 ]
```

index.js

```js
import '@babel/polyfill'
```



è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ‰“åŒ…æ—¶ï¼Œç”Ÿæˆçš„jsæ–‡ä»¶ä¼šéå¸¸å¤§ã€‚å› ä¸ºpolyfillå°†æ‰€æœ‰çš„è¯­æ³•éƒ½è¡¥å……è¿›å»äº†ã€‚æˆ‘ä»¬éœ€è¦babelæŒ‰éœ€è¡¥å……ã€‚

ä¿®æ”¹é…ç½®

```js
rules: [
  {
    //babel
    test: /\.js$/,
    use: {
      loader: 'babel-loader',
      options: {
        presets: [['@babel/preset-env', {
          useBuiltIns: 'usage', //polyfillæŒ‰éœ€å¡«å……
          targets: {
            //ç›®æ ‡æµè§ˆå™¨ è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦polyfill
            chrome: '67',
            ie: '8'
          },
        }]]
      }
    },
    exclude: /node_modules/
  },
 //...
]
```



#### 2. éä¸šåŠ¡ä»£ç é…ç½®

æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬çš„é¡¹ç›®æ˜¯ä¸€ä¸ªç»„ä»¶åº“ï¼Œç±»åº“ç­‰éä¸šåŠ¡ä»£ç ï¼Œå°±ä¸èƒ½ç”¨è¿™ç§æ‰“åŒ…æ–¹å¼äº†ã€‚å› ä¸ºpolyfillä¼šç”Ÿæˆå…¨å±€å˜é‡ï¼Œé€ æˆæ±¡æŸ“ã€‚

```js
npm i -D @babel/plugin-transform-runtime @babel/runtime @babel/runtime-corejs2 @babel/plugin-pligun-transform-runtime
```

é…ç½®æ–‡ä»¶

```js
rules: [
  {
    //babel
    test: /\.js$/,
    use: {
      loader: 'babel-loader',
      options: {
          // éä¸šåŠ¡ä»£ç é…ç½®ï¼ˆå…¶å®è¿™ä¸ªé…ç½®ä¹Ÿå¯ä»¥ç”¨åœ¨ä¸šåŠ¡é…ç½®ä»£ç ä¸Šï¼‰
          'plugins': [[
            '@babel/pligun-transform-runtime', {
              'corejs': 2,
              'helper': true,
              'regenerator': true,
              'useESModules': false
            }
          ]]
      }
    },
    exclude: /node_modules/
  },
 //...
]
```



#### 3. æŠ½ç¦»babelé…ç½®

æ ¹ç›®å½•ä¸‹æ–°å»º.babelrc

```js
// éä¸šåŠ¡ä»£ç é…ç½®ï¼ˆå…¶å®è¿™ä¸ªé…ç½®ä¹Ÿå¯ä»¥ç”¨åœ¨ä¸šåŠ¡é…ç½®ä»£ç ä¸Šï¼‰
{
  "plugins": [[
    "@babel/pligun-transform-runtime", {
      "corejs": 2,
      "helper": true,
      "regenerator": true,
      "useESModules": false
    }
  ]]
}
```

åƒè¿™æ ·å†™å°±è¡Œã€‚